{% extends "base.html" %}
{% block title %}My Rides - WheelShare{% endblock %}

{% block content %}
<div class="my-rides-page">
    <div class="page-header">
        <h1>My Rides</h1>
        <p class="subtitle">Manage your offered rides</p>
    </div>

    <div class="rides-tabs">
        <button class="tab-button active" onclick="showTab('upcoming')">Upcoming</button>
        <button class="tab-button" onclick="showTab('past')">Past</button>
        <button class="tab-button" onclick="showTab('cancelled')">Cancelled</button>
    </div>

    <div class="rides-container">
        <div id="upcoming" class="tab-content active">
            {% if not trips %}
            <div class="empty-state">
                <i class="fas fa-car"></i>
                <h3>No Upcoming Rides</h3>
                <p>You haven't offered any rides yet.</p>
                <a href="{{ url_for('new_trip') }}" class="btn btn-primary">Offer a Ride</a>
            </div>
            {% else %}
            <div class="rides-grid">
                {% for trip in trips %}
                <div class="ride-card">
                    <div class="ride-header">
                        <div class="trip-info">
                            <span class="trip-date">{{ trip.date }}</span>
                            <span class="trip-time">{{ trip.departure_time }}</span>
                        </div>
                        <div class="trip-status">
                            <span class="status-badge {{ trip.status }}">{{ trip.status }}</span>
                        </div>
                    </div>
                    <div class="route-info">
                        <div class="route-point">
                            <i class="fas fa-circle start-point"></i>
                            <span>{{ trip.from_location }}</span>
                        </div>
                        <div class="route-line"></div>
                        <div class="route-point">
                            <i class="fas fa-map-marker-alt end-point"></i>
                            <span>{{ trip.to_location }}</span>
                        </div>
                    </div>
                    <div class="trip-details">
                        <div class="detail-item">
                            <i class="fas fa-users"></i>
                            <span>{{ trip.available_seats }} seats available</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>{{ "{:,}".format(trip.price_per_seat) }} L.L. per seat</span>
                        </div>
                    </div>
                    <div class="ride-actions">
                        <a href="{{ url_for('trip_details', trip_id=trip.id) }}" class="btn btn-primary">
                            <i class="fas fa-eye"></i> View Details
                        </a>
                        <form action="{{ url_for('my_rides') }}" method="POST" style="flex: 1;">
                            <input type="hidden" name="trip_id" value="{{ trip.id }}">
                            <button type="submit" class="btn btn-danger">
                                <i class="fas fa-times"></i> Cancel Ride
                            </button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>

        <div id="past" class="tab-content">
            <div class="empty-state">
                <i class="fas fa-history"></i>
                <h3>No Past Rides</h3>
                <p>You haven't completed any rides yet.</p>
            </div>
        </div>

        <div id="cancelled" class="tab-content">
            {% set cancelled_trips = trips|selectattr('status', 'equalto', 'cancelled')|list %}
            {% if not cancelled_trips %}
            <div class="empty-state">
                <i class="fas fa-ban"></i>
                <h3>No Cancelled Rides</h3>
                <p>You don't have any cancelled rides.</p>
            </div>
            {% else %}
            <div class="rides-grid">
                {% for trip in cancelled_trips %}
                <div class="ride-card">
                    <div class="ride-header">
                        <div class="trip-info">
                            <span class="trip-date">{{ trip.date }}</span>
                            <span class="trip-time">{{ trip.departure_time }}</span>
                        </div>
                        <div class="trip-status">
                            <span class="status-badge {{ trip.status }}">{{ trip.status }}</span>
                        </div>
                    </div>
                    <div class="route-info">
                        <div class="route-point">
                            <i class="fas fa-circle start-point"></i>
                            <span>{{ trip.from_location }}</span>
                        </div>
                        <div class="route-line"></div>
                        <div class="route-point">
                            <i class="fas fa-map-marker-alt end-point"></i>
                            <span>{{ trip.to_location }}</span>
                        </div>
                    </div>
                    <div class="trip-details">
                        <div class="detail-item">
                            <i class="fas fa-users"></i>
                            <span>{{ trip.available_seats }} seats available</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>{{ "{:,}".format(trip.price_per_seat) }} L.L. per seat</span>
                        </div>
                    </div>
                    <div class="ride-actions">
                        <a href="{{ url_for('trip_details', trip_id=trip.id) }}" class="btn btn-primary">
                            <i class="fas fa-eye"></i> View Details
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.my-rides-page {
    max-width: 1200px;
    margin: 0 auto;
    padding: 24px;
}

.page-header {
    text-align: center;
    margin-bottom: 32px;
}

.page-header h1 {
    font-size: 2rem;
    margin-bottom: 8px;
}

.subtitle {
    color: var(--gray);
}

.rides-tabs {
    display: flex;
    gap: 16px;
    margin-bottom: 24px;
    border-bottom: 2px solid var(--background-color);
    padding-bottom: 8px;
}

.tab-button {
    background: none;
    border: none;
    padding: 8px 16px;
    font-size: 1rem;
    color: var(--gray);
    cursor: pointer;
    position: relative;
}

.tab-button.active {
    color: var(--primary-color);
    font-weight: 600;
}

.tab-button.active::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 0;
    right: 0;
    height: 2px;
    background-color: var(--primary-color);
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

.empty-state {
    text-align: center;
    padding: 48px;
    background: var(--white);
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.empty-state i {
    font-size: 3rem;
    color: var(--gray);
    margin-bottom: 16px;
}

.empty-state h3 {
    margin-bottom: 8px;
}

.empty-state p {
    color: var(--gray);
    margin-bottom: 24px;
}

.rides-grid {
    display: grid;
    gap: 16px;
}

.ride-card {
    background: var(--white);
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.ride-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--background-color);
}

.trip-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.trip-date {
    font-weight: 600;
}

.trip-time {
    color: var(--gray);
    font-size: 0.9rem;
}

.status-badge {
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.9rem;
    font-weight: 500;
}

.status-badge.active {
    background-color: #E8F5E9;
    color: #2E7D32;
}

.status-badge.completed {
    background-color: #E3F2FD;
    color: #1976D2;
}

.status-badge.cancelled {
    background-color: #FFEBEE;
    color: #D32F2F;
}

.route-info {
    margin-bottom: 16px;
}

.route-point {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
}

.route-line {
    width: 2px;
    height: 24px;
    background-color: var(--primary-color);
    margin-left: 7px;
}

.start-point {
    color: var(--primary-color);
    font-size: 0.8rem;
}

.end-point {
    color: var(--primary-color);
}

.trip-details {
    display: flex;
    gap: 24px;
    margin-bottom: 16px;
}

.detail-item {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--gray);
}

.ride-actions {
    display: flex;
    gap: 8px;
}

.ride-actions .btn {
    flex: 1;
}

@media (max-width: 768px) {
    .rides-tabs {
        overflow-x: auto;
        padding-bottom: 16px;
    }
    
    .ride-actions {
        flex-direction: column;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
function showTab(tabId) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // Remove active class from all tab buttons
    document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active');
    });
    
    // Show selected tab content
    document.getElementById(tabId).classList.add('active');
    
    // Add active class to clicked button
    event.target.classList.add('active');
}
</script>
{% endblock %} 