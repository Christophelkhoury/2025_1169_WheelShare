{% extends "base.html" %}
{% block title %}Trip Details - WheelShare{% endblock %}

{% block content %}
<div class="trip-details-page">
    <div class="trip-header">
        <div class="route-info">
            <div class="route-point">
                <i class="fas fa-circle start-point"></i>
                <span>{{ trip.from_location }}</span>
            </div>
            <div class="route-line"></div>
            <div class="route-point">
                <i class="fas fa-map-marker-alt end-point"></i>
                <span>{{ trip.to_location }}</span>
            </div>
        </div>
        <div class="trip-status">
            <span class="status-badge active">Active</span>
        </div>
    </div>

    <div class="trip-content">
        <div class="trip-main">
            <div class="trip-section">
                <h2>Trip Details</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <i class="far fa-clock"></i>
                        <div class="info-content">
                            <span class="info-label">Departure Time</span>
                            <span class="info-value">{{ trip.departure_time }}</span>
                        </div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-user-friends"></i>
                        <div class="info-content">
                            <span class="info-label">Available Seats</span>
                            <span class="info-value">{{ trip.available_seats }} seats</span>
                        </div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-money-bill-wave"></i>
                        <div class="info-content">
                            <span class="info-label">Price per Seat</span>
                            <span class="info-value">{{ "{:,}".format(trip.price_per_seat) }} L.L.</span>
                        </div>
                    </div>
                </div>
                <div class="trip-days">
                    <span class="days-label">Available Days:</span>
                    <div class="days-badges">
                        {% for day in ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'] %}
                        <span class="day-badge {% if day in trip.days %}active{% endif %}">
                            {{ day }}
                        </span>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="trip-section">
                <h2>Driver Information</h2>
                <div class="driver-info">
                    <img src="https://picsum.photos/64/64?random={{ trip.id }}" alt="{{ trip.driver_name }}" class="driver-avatar">
                    <div class="driver-details">
                        <h3>{{ trip.driver_name }}</h3>
                        <div class="driver-rating">
                            <div class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <span>4.5 (32 reviews)</span>
                        </div>
                        <button class="btn btn-text" onclick="location.href='/chat/{{ trip.id }}'">
                            <i class="fas fa-comment"></i> Message Driver
                        </button>
                    </div>
                </div>
            </div>

            <div class="trip-section">
                <h2>Vehicle Information</h2>
                <div class="vehicle-info">
                    <div class="info-item">
                        <i class="fas fa-car"></i>
                        <div class="info-content">
                            <span class="info-label">Car Model</span>
                            <span class="info-value">Honda Civic 2020</span>
                        </div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-palette"></i>
                        <div class="info-content">
                            <span class="info-label">Color</span>
                            <span class="info-value">Silver</span>
                        </div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-id-card"></i>
                        <div class="info-content">
                            <span class="info-label">License Plate</span>
                            <span class="info-value">ABC 123</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="trip-sidebar">
            <div class="booking-card">
                <h2>Book This Ride</h2>
                <div class="price-info">
                    <span class="price-amount">{{ "{:,}".format(trip.price_per_seat) }} L.L.</span>
                    <span class="price-per">per seat</span>
                </div>
                <form action="{{ url_for('trip_details', trip_id=trip.id) }}" method="POST" class="booking-form">
                    <div class="form-group">
                        <label for="seats">Number of Seats</label>
                        <select name="seats" id="seats" class="form-control" required>
                            {% for i in range(1, trip.available_seats + 1) %}
                            <option value="{{ i }}">{{ i }} seat{% if i > 1 %}s{% endif %}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Select Days</label>
                        <div class="days-grid">
                            {% for day in ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'] %}
                            <label class="day-checkbox">
                                <input type="checkbox" name="days" value="{{ day }}" required>
                                <span class="day-label">{{ day[:3] }}</span>
                            </label>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="booking-summary">
                        <div class="summary-item">
                            <span>Price per seat:</span>
                            <span>{{ "{:,}".format(trip.price_per_seat) }} L.L.</span>
                        </div>
                        <div class="summary-item">
                            <span>Service fee:</span>
                            <span>1,000 L.L.</span>
                        </div>
                        <div class="summary-item total">
                            <span>Total:</span>
                            <span id="totalPrice">{{ "{:,}".format(trip.price_per_seat + 1000) }} L.L.</span>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-check"></i> Book Now
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.trip-details-page {
    max-width: 1200px;
    margin: 0 auto;
    padding: 24px;
}

.trip-header {
    background: var(--white);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.route-info {
    flex: 1;
}

.route-point {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
}

.route-line {
    width: 2px;
    height: 24px;
    background-color: var(--primary-color);
    margin-left: 7px;
}

.start-point {
    color: var(--primary-color);
    font-size: 0.8rem;
}

.end-point {
    color: var(--primary-color);
}

.status-badge {
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.9rem;
    font-weight: 500;
}

.status-badge.active {
    background-color: #E8F5E9;
    color: #2E7D32;
}

.trip-content {
    display: grid;
    grid-template-columns: 1fr 320px;
    gap: 24px;
}

.trip-section {
    background: var(--white);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.trip-section h2 {
    font-size: 1.25rem;
    margin-bottom: 24px;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin-bottom: 24px;
}

.info-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
}

.info-item i {
    color: var(--primary-color);
    font-size: 1.2rem;
    margin-top: 4px;
}

.info-content {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.info-label {
    font-size: 0.9rem;
    color: var(--gray);
}

.info-value {
    font-weight: 500;
}

.trip-days {
    display: flex;
    align-items: center;
    gap: 16px;
}

.days-label {
    font-weight: 500;
}

.days-badges {
    display: flex;
    gap: 8px;
}

.day-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.9rem;
    background-color: var(--background-color);
    color: var(--gray);
}

.day-badge.active {
    background-color: var(--primary-color);
    color: var(--white);
}

.driver-info {
    display: flex;
    gap: 16px;
}

.driver-avatar {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    object-fit: cover;
}

.driver-details h3 {
    margin-bottom: 8px;
}

.driver-rating {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
}

.stars {
    color: #FFC107;
}

.vehicle-info {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
}

.booking-card {
    background: var(--white);
    border-radius: 12px;
    padding: 24px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    position: sticky;
    top: 24px;
}

.booking-card h2 {
    font-size: 1.25rem;
    margin-bottom: 16px;
}

.price-info {
    text-align: center;
    margin-bottom: 24px;
}

.price-amount {
    display: block;
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--primary-color);
}

.price-per {
    font-size: 0.9rem;
    color: var(--gray);
}

.booking-form {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.form-group label {
    font-weight: 500;
}

.days-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
}

.day-checkbox {
    position: relative;
    cursor: pointer;
}

.day-checkbox input {
    position: absolute;
    opacity: 0;
    cursor: pointer;
    height: 0;
    width: 0;
}

.day-label {
    display: block;
    padding: 8px;
    text-align: center;
    background: var(--background-color);
    border-radius: 8px;
    transition: all 0.2s;
}

.day-checkbox input:checked + .day-label {
    background: var(--primary-color);
    color: var(--white);
}

.booking-summary {
    background: var(--background-color);
    padding: 16px;
    border-radius: 8px;
    margin-bottom: 16px;
}

.summary-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    font-size: 0.9rem;
}

.summary-item.total {
    margin-top: 8px;
    padding-top: 8px;
    border-top: 1px solid var(--gray);
    font-weight: 600;
}

.btn-block {
    width: 100%;
}

@media (max-width: 768px) {
    .trip-content {
        grid-template-columns: 1fr;
    }
    
    .info-grid,
    .vehicle-info {
        grid-template-columns: 1fr;
    }
    
    .booking-card {
        position: static;
    }
}
</style>
{% endblock %} 